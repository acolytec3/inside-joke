(this.webpackJsonpjoker=this.webpackJsonpjoker||[]).push([[0],{169:function(e,t){},405:function(e,t,n){},484:function(e,t){},485:function(e,t){},516:function(e,t){},526:function(e,t){},636:function(e,t){},740:function(e,t){},742:function(e,t){},772:function(e,t){},795:function(e,t){},797:function(e,t){},827:function(e,t){},828:function(e,t){},848:function(e,t,n){"use strict";n.r(t);var r,a=n(11),c=n(0),s=n.n(c),i=n(72),o=n.n(i),u=(n(405),n(45)),l=n(224),p=n(1),d=n.n(p),b=n(26),j=n(7),f=n(372),x=n.n(f),h=n(373),O=n.n(h),v=n(374),g=n(375),w=n.n(g),m=n(376),y=n.n(m),k=n(24),S=n.n(k),C=n(377),P=n.n(C),E=n(84),I=n.n(E),K=n(378),T=n.n(K),B=n(385),F=n(102),A=n(384),D=n(869),L=n(860),R=n(872),z=n(861),J=n(870),N=n(862),Q=n(863),M=n(387),H=n(865),U=n(866),W=n(868),Y=n(867),q=n(874),G=n(42),V=n(50),X=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.keys.unmarshalPrivateKey(n.peerId.marshalPrivKey());case 2:return r=e.sent,a="",e.next=6,Object(V.pipe)(t.source,function(){var e=Object(b.a)(d.a.mark((function e(t){var n,c,s,i,o,u,l,p;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",c=!0,s=!1,e.prev=3,o=Object(G.a)(t);case 5:return e.next=7,o.next();case 7:return u=e.sent,c=u.done,e.next=11,u.value;case 11:if(l=e.sent,c){e.next=18;break}n+=l.toString("utf8");case 15:c=!0,e.next=5;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(3),s=!0,i=e.t0;case 24:if(e.prev=24,e.prev=25,c||null==o.return){e.next=29;break}return e.next=29,o.return();case 29:if(e.prev=29,!s){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(24);case 34:p=new Uint8Array(n.match(/.{1,2}/g).map((function(e){return parseInt(e,16)}))),a=(new TextDecoder).decode(r.decrypt(p));case 36:case"end":return e.stop()}}),e,null,[[3,20,24,34],[25,,29,33]])})));return function(t){return e.apply(this,arguments)}}());case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(b.a)(d.a.mark((function e(t,n,r,a){var c,s,i,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}return e.next=3,n.peerStore.get(r);case 3:if(c=e.sent,s=a.encrypt((new TextEncoder).encode(t)),i=s.reduce((function(e,t){return e+t.toString(16).padStart(2,"0")}),""),!(c&&c.addresses.length>0&&t&&n)){e.next=18;break}return e.prev=7,e.next=10,n.dialProtocol(r,["/encryptedChat/1.0"]);case 10:o=e.sent,u=o.stream,Object(V.pipe)(i,u),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),$={modules:{transport:[O.a,P.a],connEncryption:[v.NOISE],streamMuxer:[y.a],pubsub:w.a},addresses:{listen:["/dns4/wrtc-star1.par.dwebops.pub/tcp/443/wss/p2p-webrtc-star","/dns4/wrtc-star2.sjc.dwebops.pub/tcp/443/wss/p2p-webrtc-star","/ip4/127.0.0.1/tcp/13579/wss/p2p-webrtc-star"]},config:{pubsub:{enabled:!0}}};function _(){var e=s.a.useState(""),t=Object(j.a)(e,2),n=t[0],c=t[1],i=s.a.useState(),o=Object(j.a)(i,2),p=o[0],f=o[1],h=s.a.useState(!1),O=Object(j.a)(h,2),v=O[0],g=O[1],w=s.a.useState(""),m=Object(j.a)(w,2),y=m[0],k=m[1],C=s.a.useState(),P=Object(j.a)(C,2),E=P[0],K=P[1],G=s.a.useState(),V=Object(j.a)(G,2),_=V[0],ee=V[1],te=s.a.useState([]),ne=Object(j.a)(te,2),re=ne[0],ae=ne[1],ce=s.a.useState(!1),se=Object(j.a)(ce,2),ie=se[0],oe=se[1],ue=s.a.useState(!1),le=Object(j.a)(ue,2),pe=le[0],de=le[1],be=s.a.useState(!1),je=Object(j.a)(be,2),fe=je[0],xe=je[1],he=s.a.useState(!1),Oe=Object(j.a)(he,2),ve=Oe[0],ge=Oe[1],we=s.a.useState(!1),me=Object(j.a)(we,2),ye=me[0],ke=me[1],Se=Object(D.a)(),Ce=Object(L.a)(n).onCopy;s.a.useEffect((function(){Ee()}),[]),s.a.useEffect((function(){var e=function(){var t=Object(b.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=console,t.next=4,r.ping(E);case 4:t.t1=t.sent,t.t0.log.call(t.t0,"is anybody out there?",t.t1),setTimeout((function(){return e()}),5e3),t.next=19;break;case 9:t.prev=9,t.t2=t.catch(0),console.log("Error!",t.t2),Se({title:"Connection lost!",description:"Your friend seems to have disconnected.",status:"error",duration:3e3,isClosable:!0,position:"top"}),k(""),de(!1),ee(void 0),K(void 0),f(""),ae([]);case 19:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();pe&&setTimeout((function(){return e()}),5e3)}),[pe]);var Pe=function(){var e=Object(b.a)(d.a.mark((function e(){var t,n,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=36;break}return ke(!0),e.prev=2,e.next=5,S.a.createFromPubKey(y);case 5:t=e.sent,n=I.a.keys.unmarshalPublicKey(t.marshalPubKey()),e.next=16;break;case 9:return e.prev=9,e.t0=e.catch(2),console.log("Error!",e.t0),Se({title:"Invalid address",description:"Scan your friend's QR code and try again",status:"error",duration:3e3,isClosable:!0,position:"top"}),k(""),ke(!1),e.abrupt("return");case 16:a=Date.now(),c=!1;case 18:return e.prev=18,e.t1=console,e.next=22,r.ping(t);case 22:e.t2=e.sent,e.t1.log.call(e.t1,"ping ",e.t2),c=!0,e.next=32;break;case 27:return e.prev=27,e.t3=e.catch(18),e.next=31,new Promise((function(e){return setTimeout(e,2e3)}));case 31:console.log("Error!",e.t3);case 32:if(Date.now()-a<5e3&&!c){e.next=18;break}case 33:c?(K(t),ee(n),de(!0)):Se({title:"Couldn't find friend!",description:"Scan your friend's QR code and try again",status:"error",duration:3e3,isClosable:!0,position:"top"}),k(""),ke(!1);case 36:case"end":return e.stop()}}),e,null,[[2,9],[18,27]])})));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.next=3,S.a.create({bits:1024,keyType:"RSA"});case 3:if(t=e.sent,n=Object(l.a)(Object(l.a)({},$),{},{peerId:t}),!r||!r.isStarted){e.next=8;break}return e.next=8,r.stop();case 8:return e.next=10,x.a.create(n);case 10:return r=e.sent,e.next=13,r.handle("/encryptedChat/1.0",function(){var e=Object(b.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.stream,e.next=3,X(n,r);case 3:"#1512BA"===(a=e.sent)?xe(!0):("#1512AB"===a||ae((function(e){return[].concat(Object(u.a)(e),[{from:"them",message:a}])})),xe(!1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 13:return e.next=15,r.start();case 15:c(r.peerId.toJSON().pubKey),console.log("listening on: "+r.peerId.toB58String()),g(!1);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z(p,r,E,_),ae((function(e){return[].concat(Object(u.a)(e),[{from:"me",message:p}])})),f(""),ge(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(t.target.value),""===t.target.value||ve||(Z("#1512BA",r,E,_),ge(!0)),""===t.target.value&&ve&&(Z("#1512AB",r,E,_),ge(!1));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(R.b,{align:"center",w:"100vw",children:[!pe&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(z.a,{d:"flex",alignItems:"baseline",children:[Object(a.jsx)(J.a,{isLoaded:!v&&""!==n,children:Object(a.jsx)(F.a,{identifier:n})}),Object(a.jsx)(J.a,{isLoaded:!v&&""!==n,children:Object(a.jsxs)(z.a,{align:"center",children:[Object(a.jsx)(T.a,{value:n||"",size:200}),Object(a.jsx)(N.a,{mt:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",w:"200px",cursor:"pointer",onClick:Ce,children:r&&r.peerId.toJSON().pubKey})]})})]}),Object(a.jsxs)(z.a,{d:"flex",alignItems:"baseline",children:[Object(a.jsx)(J.a,{isLoaded:""!==y,children:Object(a.jsx)(F.a,{identifier:y})}),Object(a.jsxs)(z.a,{align:"center",children:[Object(a.jsx)(Q.a,{height:"200px",width:"200px",value:y,placeholder:"Peer's Public Key",type:"password",onChange:function(e){return k(e.target.value)}}),Object(a.jsxs)(R.a,{children:[Object(a.jsx)(M.a,{onClick:Pe,children:"Find a friend"}),Object(a.jsx)(M.a,{onClick:function(){return oe(!0)},children:"Read QR Code"})]})]})]})]}),pe&&Object(a.jsxs)(z.a,{children:[Object(a.jsxs)(z.a,{position:"absolute",height:"100%",w:"100vw",left:"0px",children:[re.length>0&&re.map((function(e){return Object(a.jsxs)(R.a,{children:[Object(a.jsx)(F.a,{identifier:"me"===e.from?n:y,size:48}),Object(a.jsx)(N.a,{children:e.message})]},e.message)})),fe&&Object(a.jsxs)(R.a,{children:[Object(a.jsx)(F.a,{identifier:y,size:48}),Object(a.jsx)(J.a,{children:Object(a.jsx)(N.a,{children:"Some very long message that you'll never see!!! Hello!"})})]})]}),Object(a.jsxs)(R.a,{justifyContent:"center",spacing:3,position:"fixed",bottom:"0px",left:"0px",w:"100vw",children:[Object(a.jsx)(F.a,{identifier:n,size:48}),Object(a.jsx)(H.a,{opacity:"100%",bg:"white",placeholder:"Say something",maxWidth:"300px",value:p,onChange:function(e){return Ke(e)},onKeyPress:function(e){return"Enter"===e.key&&Ie()}}),Object(a.jsx)(U.a,{"aria-label":"send message",isDisabled:""===p||!E,onClick:Ie,icon:Object(a.jsx)(A.a,{})})]})]}),Object(a.jsx)(W.a,{isOpen:ie,onClose:function(){return oe(!1)},children:Object(a.jsx)(W.d,{children:Object(a.jsx)(W.c,{children:Object(a.jsx)(W.b,{children:Object(a.jsx)(B.a,{delay:300,onError:function(e){return console.log(e)},onScan:function(e){k(e),e&&oe(!1)},style:{width:"100%"}})})})})}),Object(a.jsx)(W.a,{isCentered:!0,closeOnEsc:!1,isOpen:ye,onClose:function(){},children:Object(a.jsx)(W.d,{children:Object(a.jsx)(W.c,{children:Object(a.jsx)(W.b,{children:Object(a.jsxs)(Y.a,{h:"50px",children:[Object(a.jsx)(q.a,{mr:"10px"}),Object(a.jsx)(N.a,{children:"Phoning a friend"})]})})})})})]})}var ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,875)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},te=n(871);o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(te.a,{children:Object(a.jsx)(_,{})})}),document.getElementById("root")),ee()}},[[848,1,2]]]);
//# sourceMappingURL=main.687006e8.chunk.js.map